---
title: "Taller 4"
author: "Nathalie Bareño, Karen Vargas y Sebastián Rincón"
output: html_notebook
date: "16 de mayo"
---

```{r}
library(tidyverse)
library(readxl)
library(scales)
library(ggpubr)
```

# Cargar Bases de datos

```{r}
NorMen <- read_excel("datos/iabbd_8010_v1 (2).xls", 
                            sheet = "NOR-Men")

NorWom <- read_excel("datos/iabbd_8010_v1 (2).xls",
                     sheet = "NOR-Women")

USMen <- read_excel("datos/iabbd_8010_v1 (2).xls",
                     sheet = "USA-Men")

USWom <- read_excel("datos/iabbd_8010_v1 (2).xls",
                     sheet = "USA-Women")
HDI <- read_csv("datos/Human Development Index (HDI) (1).csv", 
                  skip = 5)

CPI <- read_delim("datos/data_csv.csv", delim = ",")

Unem <- read_excel("datos/API_SL.UEM.TOTL.ZS_DS2_es_excel_v2_2253098.xls",
                   sheet = "Data")

```

# Modificando bases de datos

```{r}
# Indice de percpeción de corrupción 
CPI <- CPI %>% select(c("Jurisdiction", "2010"))

CPI <- rename(CPI, Country = "Jurisdiction", Corruption = "2010")

# Indice de Desarrollo  Humano

HDI <- HDI %>% select(c("Country", "2010"))

HDI <- rename(HDI, Development = "2010")

# Desempleo

Unem <- Unem %>% select(c("Data Source", "...55"))

Unem <- rename(Unem, Country = "Data Source", Unemployment = "...55")

Unem <- Unem[-c(1,2,3),]

# Noruega Hombres

NorMen <- NorMen %>% select(c("Norway", "...29"))

NorMen <- rename(NorMen, Country = "Norway", HighMenNor = "...29")

NorMen <-  NorMen[-c(1,2,3),]

# Noruega Mujeres 

NorWom <- NorWom %>% select(c("Norway", "...29"))

NorWom <- rename(NorWom, Country = "Norway", HighWomNor = "...29")

NorWom <-  NorWom[-c(1,2,3),]

# Estados Unidos Hombres

USMen <- USMen %>% select(c("United States", "...29"))

USMen <- rename(USMen, Country = "United States", HighMenUS = "...29")

USMen <-  USMen[-c(1,2,3),]

# Estados Unidos Mujeres

USWom <- USWom %>% select(c("United States", "...29"))

USWom <- rename(USWom, Country = "United States", HighWomUS = "...29")

USWom <-  USWom[-c(1,2,3),]

```

# Unir

```{r}

Union1 <- left_join(NorMen,NorWom, by = "Country") 

Union2 <- left_join(USWom, USMen, by ="Country")

UnionY <- left_join(Union1, Union2, by = "Country")

Union3 <- left_join(CPI, HDI, by = "Country")

UnionX <- left_join(Union3, Unem, by = "Country")

Base <- left_join(UnionY, UnionX, by = "Country")
```

# Identificar tipo de datos

```{r}
sapply(Base, class)
```

#Modificar tipo de datos

```{r}
Base$HighMenNor <- as.numeric(Base$HighMenNor)
Base$HighWomNor <- as.numeric(Base$HighWomNor)
Base$HighMenUS <- as.numeric(Base$HighMenUS)
Base$HighWomUS <- as.numeric(Base$HighWomUS)
Base$Corruption <- as.numeric(Base$Corruption)
Base$Development <- as.numeric(Base$Development)
Base$Unemployment <- as.numeric(Base$Unemployment)

sapply(Base, class)


```


#Punto 6
Realicen un histograma y/o gráfico de barras, según se trate de una variable cuantitativa
o categórica, para la variable dependiente y para la principal variable independiente.
Las gráficas las deben realizar usando el paquete ggplot, y deben modificarlas en
cuanto a número de bins, títulos, subtítulos, etiquetas de los ejes, escalas numéricas de
los ejes y colores de una manera que permitan visualizar con claridad la información.
```{r}
ggplot(data= Base, mapping = aes(
  x=HighMenNor,
  ))+
  geom_histogram(aes(HighMenNor), bins = 20)+
  labs(tittle="Hombres Migrantes en Noruega", subtitle = "Migración de hombres con alto capital humano registrados en Noruega en el año 2010 con presedencia de todos los países del mundo", x= "Hombres migrantes con alto capital humano en Noruega", y= "Cantidad de países de origen" , caption = "Fuente=Instituto de Investigación Laboral (IAB)")


```


```{r}
ggplot(data= Base, mapping = aes(
  x=HighWomNor,
  ))+
  geom_histogram(aes(HighWomNor), bins = 20)+
  labs(tittle="Hombres Migrantes en Noruega", subtitle = "Migración de mujeres con alto capital humano registradas en Noruega en el año 2010 con presedencia de todos los países del mundo", x= "Mujeres migrantes con alto capital humano en Noruega", y= "Cantidad de países de origen" , caption = "Fuente=Instituto de Investigación Laboral (IAB)")


```

```{r}
ggplot(data= Base, mapping = aes(
  x=HighMenUS,
  ))+
  geom_histogram(aes(HighMenUS), bins = 20)+
  labs(tittle="Hombres Migrantes en Estados Unidos", subtitle = "Migración de Hombres con alto capital humano registrados en Estados Unidos en el año 2010 con presedencia de todos los países del mundo", x= "Hombres migrantes con alto capital humano en Estados Unidos", y= "Cantidad de países de origen" , caption = "Fuente=Instituto de Investigación Laboral (IAB)")


```


```{r}
ggplot(data= Base, mapping = aes(
  x=HighWomUS,
  ))+
  geom_histogram(aes(HighWomUS), bins = 20)+
  labs(tittle="Mujeres Migrantes en Estados Unidos", subtitle = "Migración de Mujeres con alto capital humano registradas en Estados Unidos en el año 2010 con presedencia de todos los países del mundo", x= "Mujeres migrantes con alto capital humano en Estados Unidos", y= "Cantidad de países de origen" , caption = "Fuente=Instituto de Investigación Laboral (IAB)")


```

```{r}
ggplot(data= Base, mapping = aes(
  x=Development,
  ))+
  geom_histogram(aes(Development), bins = 15)+
  labs(tittle="Indice de desarrollo humano", x= "Indice de desarrollo humano", y= "Cantidad de países de origen" , caption = "Fuente= UNESCO Institute for Statistics")


```


#Unión de las graficas
```{r}

```
#Punto 7
Para las variables cuantitativas (continuas y discretas), calculen la correlación entre
cada pareja de variables y presenten estas correlaciones en una matriz de correlaciones.
Para las variables categóricas hagan una tabla cruzada para cada par de variables. En
ambos casos, comente sobre los resultados más relevantes.

```{r}
#Correlación de HighMenNor

library(PerformanceAnalytics)
dat1 <- data.frame(Base$HighMenNor, Base$Development)
chart.Correlation(dat1)

dat2 <- data.frame(Base$HighMenNor, Base$Corruption)
chart.Correlation(dat2)

dat3 <- data.frame(Base$HighMenNor, Base$Unemployment)
chart.Correlation(dat3)



```







# Punto 8

Realicen una gráfica que les permita relacionar la variable dependiente y la principal variable independiente de interés. Si tienen varias variables independientes de interés, realicen una grpafica para mostrar la relación entre cada una de estas variables y la variable dependiente. Realicen las transformaciones en las variables que consideren necesarias para mostrar de mejor manera la información en estas gráficas. Las gráficas las deben realizar usando el paquete *ggplot*, y deben modificar los títulos, etiquetas de los ejes, escalas numéricas de los ejes y colores de una manera que permitan visualizar con claridad la información. Siga las siguientes recomendaciones:

 - Sí las dos variables son cuantitativas el gráfico debe ser un diagrama de dispersión.
 - Sí las dos variables son categóricas el gráfico debe ser un gráfico de barras que permita visualizar las dos variables.
 - Sí una variable es cuantitativa y la otra categ´rica, en un mismo gráfico realice un polígono de frecuencia, una densidad o un diagrama de cajas de la variable cuantitativa para cada una de las categorías de la variable categórica. Por ejemplo, fi fueran a analizar la relación entre el tipo de colegio y puntaje, debería hacer un polígono de fercuencias, una densidad o un diagrama de cajas para el puntaje para los colegios públicos y otro para los colegios privados. Ambos polígonos o densidades deberían estar en la misma gráfica (i.e. mismo plano cartesiano) para poder apreciar las diferencias en la distribución de los puntajes de los estudiantes de ambos tipos de colegios. Si la variable categórica tuviera más de tres categorías, la gráfica podría hacerse con una función *facet_*.
 
Poseemos 4 variables dependientes seccionadas en Noruega y Estados Unidos las cuales también se encuentran dividas por si los inmigrantes fueron mujeres o hombres. La principal variable de interés es el índice de desarrollo humano.

```{r}
a8 <- ggplot(data = Base, 
       mapping = aes(x = Development, y = HighMenUS)) +
  geom_point(color = "blue") +
  scale_y_continuous(labels = label_number()) +
  labs(subtitle = "Dispersograma inmigración Masculina hacía los Estados Unidos", x = "Índice de Desarrollo Humano", y = "Número de inmigrantes altamente cualificados(2010)")
```

```{r}
b8 <- ggplot(data = Base, 
       mapping = aes(x = Development, y = HighWomUS)) +
  geom_point(color = "red") +
  scale_y_continuous(labels = label_number()) +
  labs(subtitle = "Dispersograma inmigración Femenina hacía los Estados Unidos", x = "Índice de Desarrollo Humano", y = "Número de inmigrantes altamente cualificados(2010)")
```

```{r}
c8 <- ggplot(data = Base, 
       mapping = aes(x = Development, y = HighWomNor)) +
  geom_point(color = "red") +
  scale_y_continuous(labels = label_number()) +
  labs(subtitle = "Dispersograma inmigración Femenina hacía Noruega", x = "Índice de Desarrollo Humano", y = "Número de inmigrantes altamente cualificados(2010)")
```

```{r}
d8 <- ggplot(data = Base, 
       mapping = aes(x = Development, y = HighMenNor)) +
  geom_point(color = "blue") +
  scale_y_continuous(labels = label_number()) +
  labs(subtitle = "Dispersograma inmigración Masculina hacía Noruega", x = "Índice de Desarrollo Humano", y = "Número de inmigrantes altamente cualificados(2010)")
```

```{r}
ggarrange(a8,b8,c8,d8)
```

